# **SQLD Day 24 – 복원 기출 3회 해설, 복합 쿼리·집계 실전 분석 (2025-11-05)**

> 📘 SQLD 2과목 | SQL 기본 및 응용  
> 🧑‍💻 학습자: Jaerok Kim (Raprok612)

---

## **🎯 학습 목표**

- SQLD 복원 기출 3회 문제(복합 쿼리, 집계 함수 중심) 해설 및 실전 풀이  
- UNION, INTERSECT, MINUS 등의 집합 연산과 GROUP BY 결합형 문제 분석  
- 실제 시험형 쿼리 풀이 패턴 및 실수 포인트 점검

---

## **🧠 이론 정리**

### **1️⃣ 집합 연산자 (Set Operators)**

| 연산자 | 설명 | 특징 |
|--------|------|------|
| **UNION** | 두 SELECT 결과 합집합 (중복 제거) | 자동 정렬 발생 |
| **UNION ALL** | 합집합 (중복 포함) | 빠르지만 중복 있음 |
| **INTERSECT** | 교집합 | 중복 제거 |
| **MINUS** | 차집합 | 첫 번째 쿼리 기준 |

```sql
SELECT EMPNO, ENAME FROM EMP
UNION
SELECT EMPNO, ENAME FROM EMP_BK;
```

> ⚙️ 컬럼 수와 타입이 동일해야 집합 연산 가능.

---

### **2️⃣ 그룹 함수 및 집계 응용**

| 함수 | 설명 | 예시 |
|------|------|------|
| **ROLLUP** | 다단계 집계 | `GROUP BY ROLLUP(DEPTNO, JOB)` |
| **CUBE** | 모든 조합 집계 | `GROUP BY CUBE(DEPTNO, JOB)` |
| **GROUPING()** | 집계 구분자 | `GROUPING(DEPTNO)` → 1=집계행 |
| **GROUPING SETS** | 특정 집합만 집계 | `GROUP BY GROUPING SETS((DEPTNO), (JOB))` |

```sql
SELECT DEPTNO, JOB, SUM(SAL)
FROM EMP
GROUP BY ROLLUP(DEPTNO, JOB);
```

> 💡 ROLLUP은 계층적 합계, CUBE는 다차원 합계.

---

### **3️⃣ 복합 쿼리 응용 (집합 + 집계 결합)**

```sql
SELECT DEPTNO, COUNT(*) AS CNT FROM EMP
GROUP BY DEPTNO
UNION ALL
SELECT NULL, COUNT(*) FROM EMP;
```

> ⚙️ 집계 함수와 UNION ALL을 결합하여 전체 합계 행 추가.

---

## **🧮 예제 및 실습**

**예제 1️⃣ – UNION / UNION ALL 비교**
```sql
SELECT DEPTNO FROM EMP
UNION
SELECT DEPTNO FROM DEPT;
```

**예제 2️⃣ – ROLLUP 활용**
```sql
SELECT DEPTNO, JOB, SUM(SAL)
FROM EMP
GROUP BY ROLLUP(DEPTNO, JOB);
```

**예제 3️⃣ – CUBE 비교**
```sql
SELECT DEPTNO, JOB, SUM(SAL)
FROM EMP
GROUP BY CUBE(DEPTNO, JOB);
```

- [x] UNION vs UNION ALL 결과 비교  
- [x] ROLLUP / CUBE 차이점 실습  
- [x] GROUPING 함수 활용법 숙지  

---

## **🧾 기출 복습**

| 회차 | 문항 | 주제 | 결과 | 비고 |
|------|------|------|------|------|
| 복원 3회 | Q1–Q10 | UNION / INTERSECT / MINUS | ✅ | 컬럼 일치성 확인 |
| 복원 3회 | Q11–Q15 | ROLLUP / CUBE / GROUPING | ⚠ | NULL 처리 혼동 |
| 복원 3회 | Q16–Q20 | GROUPING SETS 실전 응용 | ✅ | 다단계 집계 완전 이해 |

> 📘 기출 출처: 아이리포 SQLD 강의 – 복원 기출문제 3회 (유튜브 41-1~41-5강)

---

## **💬 느낀점 / 메모**

- 집합 연산자(UNION, INTERSECT)는 컬럼 수·데이터형 일치가 필수임을 다시 확인했다.  
- ROLLUP과 CUBE의 차이는 ‘계층형 vs 다차원형’으로 이해하니 명확해졌다.  
- 실제 시험에서는 GROUPING 함수와 함께 복합 집계가 자주 등장한다.

---

## **🔗 참고자료**

- 아이리포 SQLD 강의 – 2과목 복원기출 3회 해설 (유튜브 41-1~41-5강): 집합 연산 / ROLLUP / CUBE / GROUPING SETS  
- SQLD 공식 교재 2권 p.299~312  
- [아이리포 공식 유튜브 채널 – SQLD 모든 것](https://www.youtube.com/@irepo_official)
