# **SQLD Day 17 – 복합쿼리 실전 ① (JOIN · GROUP BY 결합형) (2025-10-29)**

> 📘 SQLD 2과목 | SQL 기본 및 응용  
> 🧑‍💻 학습자: Jaerok Kim (Raprok612)

---

## 🎯 학습 목표
- JOIN + GROUP BY 결합 문제 풀이 패턴 숙득  
- 실전 복합쿼리 흐름 완전히 이해  
- WHERE / HAVING / JOIN 조건의 차이 정확히 구분  
- SQLD 실전에서 가장 자주 등장하는 복합형 문제 대응

---

## 🧠 이론 정리

### 1️⃣ 복합쿼리 실행 순서(가장 중요)
복합쿼리 해석은 **실행 순서를 아는 것**으로 시작된다.

1. **FROM / JOIN**  
2. **WHERE**  
3. **GROUP BY**  
4. **HAVING**  
5. **SELECT**  
6. **ORDER BY**

JOIN → 필터링 → 그룹화 → 그룹필터 → 출력 → 정렬

이 흐름을 모르면 복합문제 90%는 틀린다.

---

### 2️⃣ JOIN + GROUP BY 결합 포인트

#### ✔ JOIN 단계에서 데이터 구조가 결정됨  
JOIN 결과의 “행 수”에 따라 집계 결과가 완전히 달라짐.

#### ✔ GROUP BY = 묶음 생성  
JOIN된 데이터에서 **새로운 집계 테이블을 만든다.**

#### ✔ WHERE vs HAVING  
둘의 차이는 시험에서도 단골 함정.

| 구분 | 설명 | 적용 시점 |
|------|------|----------|
| **WHERE** | 개별 행 필터링 | GROUP BY 이전 |
| **HAVING** | 집계 결과 필터링 | GROUP BY 이후 |

---

## 🧩 대표 문제 패턴

### ✔ 패턴 1 — 부서별 총 급여와 JOIN 결합
```sql
SELECT D.deptno, D.dname, SUM(E.sal) AS total_sal
FROM dept D
JOIN emp E ON D.deptno = E.deptno
GROUP BY D.deptno, D.dname;
```

---

### ✔ 패턴 2 — WHERE + HAVING 조합
```sql
SELECT D.deptno, COUNT(*) AS cnt
FROM dept D
JOIN emp E ON D.deptno = E.deptno
WHERE E.sal > 2000
GROUP BY D.deptno
HAVING COUNT(*) >= 2;
```

---

### ✔ 패턴 3 — JOIN + 집계 + 정렬
```sql
SELECT D.deptno, AVG(E.sal) AS avg_sal
FROM dept D
LEFT JOIN emp E ON D.deptno = E.deptno
GROUP BY D.deptno
ORDER BY avg_sal DESC;
```

---

## ⚙️ 핵심 요약
- JOIN → GROUP BY 순서를 이해하면 복합쿼리 문제의 80% 해결  
- WHERE/HAVING의 역할을 구분해야 틀리지 않음  
- JOIN 결과를 먼저 머릿속에 그린 다음 집계를 생각해야 함  
- SQLD에서 복합쿼리형이 가장 많이 출제됨  

---

## 🧾 기출 복습

| 회차 | 문항 | 주제 | 결과 | 비고 |
|------|------|------|--------|------|
| 기출 1회 | Q10–Q15 | JOIN + 집계 | ⚠ | WHERE/HAVING 혼동 |
| 기출 2회 | Q16–Q20 | 복합쿼리 | ✅ | JOIN 조건 구조 이해 |
| 기출 3회 | Q11–Q15 | JOIN+GROUP BY | ⚠ | LEFT JOIN 주의 |

---

## 💬 느낀점
- JOIN 단계에서 데이터가 어떻게 변하는지 먼저 예측해야 GROUP BY가 쉬워진다.  
- WHERE/HAVING의 구분은 단순 규칙이 아니라 “실행 구조”의 차이라는 점을 깨달았다.  
- 복합쿼리는 단순 문법이 아니라 전체 흐름을 읽는 능력이 중요하다.

---

## 🔗 참고자료
- 아이리포 SQLD 강의 – 2과목 17강  
- SQLD 공식 교재 2권 p.211~225  
